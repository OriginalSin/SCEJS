<html>
	<head>
		<title>SCEJS NeuronalNetwork</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		
		<script src="../../SCEJS/SCE.class.js"></script>

		<script src="../../SCEJS/Prefabs/SimpleCamera/SimpleCamera.class.js"></script>

		<script src="../../SCEJS/Prefabs/Grid/VFP_GRID.class.js"></script>
		<script src="../../SCEJS/Prefabs/Grid/Grid.class.js"></script>

		<script src="../../SCEJS/Prefabs/Graph/Graph.class.js"></script>
	</head>

	<body>
		<div id="SCEJS"></div>
		<br />
        <div id="SCEJSB"></div>

		<script>
			var sce = new SCE();
			sce.initialize({"target": document.getElementById("SCEJS"),
							"dimensions": {"width": 256, "height": 256}});


			var project = new Project();
			sce.loadProject(project);

			var stage = new Stage();
			project.addStage(stage);
			project.setActiveStage(stage);

			// CAMERA
			var simpleCamera = new SimpleCamera(sce);
			simpleCamera.setView(Constants.VIEW_TYPES.TOP);
			simpleCamera.setVelocity(1.0);
			sce.setDimensions(512, 512);
			
			// GRID
			//var grid = new Grid(sce);
			//grid.generate(100.0, 1.0);


			// GRAPH NEURONAL NETWORK
            var OFFSET = 1000.0;
            var offs = OFFSET/10;

            var graph = new Graph(sce);
            graph.enableNeuronalNetwork();
            graph.setOffset(OFFSET);

            var mesh_point = new Mesh().loadPoint();
            //graph.setNodeMesh(mesh_point);


            graph.setFontsImage("../../SCEJS/Prefabs/Graph/fonts.png");


            graph.addNeuron("color"); // efferent neuron (actuator)
            graph.addNeuron("R"); // afferent neuron (sensor)
            graph.addNeuron("G"); // afferent neuron
            graph.addNeuron("B"); // afferent neuron
            graph.addSinapsis("R", "color");
            graph.addSinapsis("G", "color");
            graph.addSinapsis("B", "color");
            graph.updateNodes();
            graph.updateLinks();

			//*********
			// RENDER STAGE
			//*********
			project.getActiveStage().render();


			window.onresize = (function() {
				//sce.setDimensions(512, 128);
		    }).bind(this);
		</script>
		
		T for top view<br />
		Alt+LeftMouse for Orbit<br />
		Alt+MiddleMouse for Pan<br />		
		P for perspective view<br />
		WASD for to move<br />

        <button id="BTNID_AFFERENCEDATA">random afference data</button> Input data<br />
        <button id="BTNID_EFFERENCEDATA0">efference data 0</button> Train output from current afference data updating link weights<br />
        <button id="BTNID_EFFERENCEDATA1">efference data 1</button> Train output from current afference data updating link weights<br />
        <button id="BTNID_NETWORKSTEP">network step</button> <br />
		<script>
            document.getElementById("BTNID_AFFERENCEDATA").addEventListener("click", (function() {
                graph.setAfferentData({ "R": (Math.random()*2.0)-1.0,
                                        "G": (Math.random()*2.0)-1.0,
                                        "B": (Math.random()*2.0)-1.0});
            }).bind(this));

            document.getElementById("BTNID_EFFERENCEDATA0").addEventListener("click", (function() {
                graph.setEfferentData({"color": 0.0});
            }).bind(this));
            document.getElementById("BTNID_EFFERENCEDATA1").addEventListener("click", (function() {
                graph.setEfferentData({"color": 1.0});
            }).bind(this));

            document.getElementById("BTNID_NETWORKSTEP").addEventListener("click", (function() {
                graph.makeNetworkStep();
            }).bind(this));
		</script>
	</body>
</html>
